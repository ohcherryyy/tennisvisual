<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <title>ECharts</title>
    <!-- 引入 echarts.js -->
    
    <title>list</title>
    <style>
        *{margin:0;padding:0}
        html,body{
            width:100%;
            height:100%;
        }
        #main {
              width:document.body.clientWidth;
              height:740px;        
              padding:5px;     
              margin: 0px auto;
              border: 5 px solid #ddd;
              
          }
          .search{
            position:absolute;
            left:6.8%;
            top:7.3%;
            z-index: 999;
            width:220px
        }
    </style>
</head>
<body>
    <script src="echarts/incubator-echarts-4.6.0/dist/echarts.js"></script>
    <script src="jquery-1.11.3.min.js"></script>
    <script src="visualization/creategraph.js"></script>
    <script src="matchstat/matchstat/json/ausopennodes.js"></script>
    <script src="matchstat/matchstat/json/ausopenlinks.js"></script>
    <script src="https://code.jquery.com/jquery.js"></script>
    
    <div class="container-fluid">
        <div class="search">
            <div class="input-group mb-3">
                <input type="text" class="form-control" placeholder="搜索感兴趣的运动员名字" id="search" aria-describedby="basic-addon1" onkeydown="entersearch()">
                <br>
                    <button type="button" class="btn btn-outline-secondary" text-align="center" onclick="searchsportsman()">
                        <svg class="bi bi-search" width="18px" height="18px" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z" clip-rule="evenodd"/>
                            <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z" clip-rule="evenodd"/>
                        </svg>
                    </button>                   
                
            </div>
        </div>  
        <div id="main"></div>
    </div>
    
    <script type="text/javascript">
    var nodes=ausopennodes()
    var links=ausopenlinks()
    
    var categoriesname=[
        {
            name:'冠军',
        },
        {
            name:'亚军',
        },
        {
            name:'4强',
        },
        {
            name:'8强',
        },
        {
            name:'16强',
        },
        {
            name:'32强',
        },
        {
            name:'64强',
        },
        {
            name:'128强',
        }]
        
    var myChart = echarts.init(document.getElementById('main'));        
    option=getOption(nodes,links,categoriesname);
    myChart.setOption(option)
    
    function searchsportsman(){
        value=document.getElementById('search').value
        location.href="personal.html?"+"&txt="+value+"&year=0"
    }
    function entersearch(){
        //alert(dd);
        var event = window.event || arguments.callee.caller.arguments[0];
        if (event.keyCode == 13)
        {
            searchsportsman()
        }
    }
 
    function getURL(winner,loser){
        var img=[]
        for(var i=0;i<nodes.length;i++){
            for(var j=0;j<nodes[i].length;j++){
                if(nodes[i][j].name==winner)
                {
                    img['winner']=nodes[i][j].symbol
                }
                else if (nodes[i][j].name==loser)
                {
                    img['loser']=nodes[i][j].symbol
                }
            }
        }
        return img
    }

    // myChart.on('mouseover',function(params){
    //         console.log(params)
    // })
    
    var year=0

    // myChart.on('mouseover',function(params){
    //         console.log(params)
    // })

    myChart.on('Click',function(params){
        if(params.componentType=='timeline'){
            year=params.dataIndex
        }
        if(params.dataType=='edge'){
        var statid=params.data.id;
        var winner=params.data.target;
        var loser=params.data.source;
        img=getURL(winner,loser)       
        location.href="stat.html?"+"&txt="+encodeURI(statid)+"&winner="+encodeURI(winner)+"&loser="+encodeURI(loser)+"&winnerimg="+encodeURI(img['winner'])+"&loserimg="+encodeURI(img['loser']);
        }
        if(params.dataType=='node'){
            var name=params.data.name;
            location.href="personal.html?"+"&txt="+encodeURI(name)+"&year="+encodeURI(year);
        }  
    })
    window.onresize=function(){
        myChart.resize();
    }

    </script>
</body>